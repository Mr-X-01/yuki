# Yuki VPN - Windows Client

–°—Ç–µ–ª—Å VPN-–∫–ª–∏–µ–Ω—Ç –¥–ª—è Windows —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π WinTun –¥—Ä–∞–π–≤–µ—Ä–∞ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ WinTun –¥—Ä–∞–π–≤–µ—Ä–∞

–ó–∞–ø—É—Å—Ç–∏—Ç–µ PowerShell –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```powershell
.\install-wintun.ps1
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–∫–∞—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é WinTun
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –¥—Ä–∞–π–≤–µ—Ä –≤ —Å–∏—Å—Ç–µ–º—É
- –°–∫–æ–ø–∏—Ä—É–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ DLL —Ñ–∞–π–ª—ã

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `config-example.json` –≤ `config.json` –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ:

```bash
copy config-example.json config.json
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `server.address` - –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ Yuki —Å–µ—Ä–≤–µ—Ä–∞
- `server.tls.server_name` - –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞
- `auth.uuid` - –≤–∞—à UUID –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `auth.secret` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á
- `tunnel.ip` - IP –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Ç—É–Ω–Ω–µ–ª–µ

### 3. –ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞

```bash
.\yuki-client.exe -config config.json
```

## üìã –ö–æ–º–∞–Ω–¥—ã

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
.\yuki-client.exe -generate-config
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–æ–º
```bash
.\yuki-client.exe -config config.json -daemon
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```bash
.\yuki-client.exe -status
```

### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ
```bash
.\yuki-client.exe -disconnect
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

#### Server Configuration
```json
{
  "server": {
    "address": "api.example.ru:443",
    "tls": {
      "enabled": true,
      "verify_certificate": true,
      "server_name": "api.example.ru"
    }
  }
}
```

#### Authentication
```json
{
  "auth": {
    "uuid": "12345678-1234-5678-9abc-123456789012",
    "secret": "your-secret-key-here"
  }
}
```

#### Tunnel Settings
```json
{
  "tunnel": {
    "interface_name": "YukiVPN",
    "mtu": 1420,
    "ip": "10.8.0.2",
    "netmask": "255.255.255.0",
    "gateway": "10.8.0.1",
    "dns": ["8.8.8.8", "8.8.4.4"]
  }
}
```

#### Routing
```json
{
  "routing": {
    "route_all_traffic": true,
    "exclude_routes": [
      "192.168.0.0/16",
      "10.0.0.0/8"
    ]
  }
}
```

## üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°:** Windows 10 –≤–µ—Ä—Å–∏–∏ 1607+ –∏–ª–∏ Windows Server 2016+
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** x64 –∏–ª–∏ x86
- **–ü—Ä–∞–≤–∞:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ –ø—Ä–∞–≤–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ WinTun
- **–°–µ—Ç—å:** –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å—Ç–µ–ª—Å-—Ñ—É–Ω–∫—Ü–∏–∏

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- **–ê–ª–≥–æ—Ä–∏—Ç–º:** XChaCha20-Poly1305
- **–†–∞–∑–º–µ—Ä –∫–ª—é—á–∞:** 256 –±–∏—Ç
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** UUID + —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á

### –°—Ç–µ–ª—Å-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** –ó–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ gRPC —Ç—Ä–∞—Ñ–∏–∫
- **TLS:** –ü–æ–ª–Ω–∞—è –∏–º–∏—Ç–∞—Ü–∏—è HTTPS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- **Fingerprinting:** –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Chrome/Go User-Agent
- **DPI Evasion:** –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ gRPC —Ñ—Ä–µ–π–º—ã

### Traffic Shaping
```json
{
  "stealth": {
    "enable_traffic_shaping": true,
    "packet_delay_ms": 10,
    "burst_limit": 100
  }
}
```

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `debug` - –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `info` - –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ
- `warn` - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `error` - –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏

### –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```json
{
  "client": {
    "log_level": "info",
    "log_file": "yuki-client.log"
  }
}
```

## üîÑ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª—É–∂–±—ã Windows

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `yuki-service.xml`:
```xml
<service>
    <id>YukiVPN</id>
    <name>Yuki VPN Client</name>
    <description>Yuki VPN Service</description>
    <executable>C:\Path\To\yuki-client.exe</executable>
    <arguments>-config C:\Path\To\config.json -daemon</arguments>
    <logmode>rotate</logmode>
</service>
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª—É–∂–±—É —Å –ø–æ–º–æ—â—å—é WinSW –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.

## ‚ùó –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π

### WinTun –Ω–µ –Ω–∞–π–¥–µ–Ω
```
ERROR: WinTun DLL not loaded
```
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ `install-wintun.ps1` –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```
ERROR: connection refused
```
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∞–¥—Ä–µ—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–∞ 443
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞

### –ù–µ–≤–µ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
```
ERROR: authentication failed
```
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å UUID –∏ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –ü—Ä–æ–±–ª–µ–º—ã —Å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π
```
ERROR: failed to set routes
```
**–†–µ—à–µ–Ω–∏–µ:**
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ Windows

## üìù –õ–æ–≥–∏

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- –§–∞–π–ª, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- Windows Event Log (–ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –∫–∞–∫ —Å–ª—É–∂–±–∞)
- –ö–æ–Ω—Å–æ–ª—å (–ø—Ä–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º –∑–∞–ø—É—Å–∫–µ)

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
```powershell
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤
Get-Content yuki-client.log -Tail 50

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—à–∏–±–æ–∫
Select-String "ERROR" yuki-client.log

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
Get-Content yuki-client.log -Wait
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π

### –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
–ö–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–µ—Ç–µ–≤–æ–π –∞–¥–∞–ø—Ç–µ—Ä `YukiVPN` —á–µ—Ä–µ–∑ WinTun.

### DNS
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ DNS —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è —Ç—É–Ω–Ω–µ–ª—è —Å–æ–≥–ª–∞—Å–Ω–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

### –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü–µ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ Windows –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ —á–µ—Ä–µ–∑ VPN.

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞](../docs/DEPLOYMENT.md)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](../docs/ARCHITECTURE.md)
- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç WinTun](https://www.wintun.net/)

---

**Yuki VPN** - –ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤ –†–æ—Å—Å–∏–∏
